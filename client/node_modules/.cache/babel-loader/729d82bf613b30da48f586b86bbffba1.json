{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/hyunkang/Desktop/School/3-2/\\u1103\\u1166\\u110B\\u1175\\u1110\\u1165\\u1107\\u1166\\u110B\\u1175\\u1109\\u1173/Database2020/client/src/Components/SubmitterSubmit.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, Component, useEffect } from \"react\";\nimport styles from \"../CSS/component.module.css\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { useHistory } from \"react-router-dom\";\nimport { colors, IconButton } from \"@material-ui/core\";\nimport { parse } from \"papaparse\";\nimport { RPair } from \"../Components/classes\";\nimport Select from \"react-select\";\nexport const SubmitterSubmit = ({\n  taskName,\n  taskDesc,\n  setTogglePopUp\n}) => {\n  _s();\n\n  var logInfo;\n  var history = useHistory();\n  const loggedIn = localStorage.getItem(\"user\");\n\n  if (loggedIn) {\n    logInfo = JSON.parse(loggedIn);\n  } else {\n    history.push(\"/\");\n  }\n\n  const [RDTtypes, setRDTtypes] = useState();\n  const [RDTID, setRDT] = useState();\n  const [highlighted, setHighlighted] = React.useState(false);\n  const [file, setFile] = useState([]);\n  const [LastRDSFID, setLastRDSFID] = useState([]);\n  const [RDSFID, setRDSFID] = useState();\n\n  const axios = require(\"axios\").default;\n\n  const [uploadState, setUploadState] = useState(\"제출할 파일을 끌어다 놓으시오.\");\n  var lst = []; //\n\n  const [trmap, setTRMap] = useState();\n  const [trmaplist, setTRMaplist] = useState([]);\n  const [pdsfID, setPDSFID] = useState();\n  const [qtestID, setQTESTID] = useState([]);\n  var aID = logInfo.accountID;\n  var pID;\n  var qID; //console.log(aID);\n\n  useEffect(() => {\n    async function fetchData() {\n      await axios.get(`/api/RDTtypes/${taskName}`).then(res => {\n        setRDTtypes(res.data);\n      });\n    }\n\n    fetchData();\n  }, []);\n  useEffect(() => {\n    async function fetchData() {\n      await axios.get(`/api/getLastRDSFID/${logInfo.accountID}`).then(res => {\n        setLastRDSFID(res.data);\n      });\n    }\n\n    fetchData();\n  }, []);\n  useEffect(() => {\n    for (let i = 0; i < LastRDSFID.length; i++) {\n      if (LastRDSFID[i].LastRDSFID == null) {\n        setRDSFID(1);\n      } else {\n        setRDSFID(LastRDSFID[i].LastRDSFID + 1);\n      }\n    }\n  }, [LastRDSFID]);\n  useEffect(() => {\n    if (!trmap) return;\n    var trmaplist = [];\n\n    for (let i = 0; i < trmaplist.length; i++) {\n      trmaplist.push(new RPair(trmaplist[i].name, trmaplist[i].type, trmaplist[i].map));\n    }\n\n    setTRMaplist(trmaplist);\n  }, [trmap]);\n\n  const Upload = async () => {\n    // process uploading\n    console.log(RDTID);\n    console.log(RDSFID);\n    await axios.post(`/api/file/SubmitterID_${logInfo.accountID}/${taskName}/RDTID_${RDTID}`, {\n      SubmitterID: logInfo.accountID,\n      TaskName: taskName,\n      RDTID: RDTID,\n      RDSFID: RDSFID,\n      file: file\n    }).then(function (response) {\n      console.log(response);\n    }).catch(function (error) {\n      console.log(error);\n    });\n    await axios.get(`/api/TRMap/${RDTID}`).then(res => {\n      setTRMap(res.data);\n      var obj = JSON.parse(JSON.stringify(res.data));\n      console.log(obj[0].Pair);\n      var obj1 = JSON.parse(obj[0].Pair);\n      var obj2 = JSON.parse(obj[0].RPair);\n      console.log(obj1);\n      console.log(obj2);\n\n      for (let i = 0; i < obj1.length; i++) {\n        if (obj2[i].constructor != Object) {\n          var n = obj1[1].name;\n          console.log(obj1[i].name);\n\n          for (let j = 0; j < file.length; j++) {\n            delete file[i].n;\n          }\n        }\n      }\n\n      console.log(file);\n    });\n    /*\n     */\n    //        var obj = JSON.parse(trmap);\n\n    /*\n    var logInfo;\n    var history = useHistory();\n    const loggedIn = localStorage.getItem(\"user\");\n    if (loggedIn) {\n      logInfo = JSON.parse(loggedIn);\n    } else {\n      history.push(\"/\");\n    }\n    await axios\n      .post(\"/api/file/rdsf\", {\n          SubmitterID: logInfo.accountID,\n          RawDataType: rdt,\n      })\n      .then(function (response) {\n          //console.log(response);\n      })\n      .catch(function (error) {\n          //console.log(error);\n      });\n      */\n    //rdsf.query->parsing->pdsf.query->    upload->assigning->assign.query->qt.query\n    //submitterid_taskid_rawdatatypeid\n\n    await axios.post(\"/api/parse/\" + `${RDSFID}`).then(function (response) {//console.log(response);\n    }).catch(function (error) {//console.log(error);\n    }); ///////////////12.06.0700\n\n    await axios.get(`/api/getPDSFID/` + `${RDSFID}`).then(res => {\n      console.log(RDSFID);\n      console.log(res.data[0].PDSFID);\n      setPDSFID(res.data[0].PDSFID);\n      pID = res.data[0].PDSFID;\n    });\n    console.log(pID);\n    await axios.post(\"/api/addQT/\" + `${pID}`).then(function (response) {//console.log(response);\n    }).catch(function (error) {//console.log(error);\n    });\n    await axios.get(`/api/getQTESTID/` + `${pID}`).then(res => {\n      console.log(res.data);\n      setQTESTID(res.data.TestID);\n      qID = res.data[0].TestID;\n    });\n    await axios.post(\"/api/assign/\" + `${pID}/${qID}`, {}).then(function (response) {//console.log(response);\n    }).catch(function (error) {//console.log(error);\n    });\n    setTogglePopUp(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.popup_sub,\n    children: [/*#__PURE__*/_jsxDEV(IconButton, {\n      className: styles.close_btn,\n      style: {\n        position: \"absolute\"\n      },\n      onClick: () => setTogglePopUp(false),\n      children: /*#__PURE__*/_jsxDEV(CloseIcon, {\n        fontSize: \"large\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.info,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\uD0DC\\uC2A4\\uD06C \\uC774\\uB984\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: taskName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.info,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\uD0DC\\uC2A4\\uD06C \\uC815\\uBCF4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: taskDesc\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\uD30C\\uC77C \\uC5C5\\uB85C\\uB4DC\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${styles.file_input} ${highlighted ? `${styles.border_blue}` : `${styles.border_black}`}`,\n      onDragEnter: () => {\n        setHighlighted(true);\n      },\n      onDragLeave: () => {\n        setHighlighted(false);\n      },\n      onDragOver: e => {\n        e.preventDefault();\n      },\n      onDrop: e => {\n        e.preventDefault();\n        setHighlighted(false);\n        Array.from(e.dataTransfer.files).filter(file => file.type === \"text/csv\").forEach(async file => {\n          const text = await file.text();\n          const result = parse(text, {\n            header: true\n          });\n          console.log(result);\n          setFile(existing => [...existing, ...result.data]);\n        });\n      },\n      children: uploadState\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.info,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Raw Data Type\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Select, {\n        options: RDTtypes,\n        placeholder: \"Raw Data Type\\uC744 \\uC120\\uD0DD\\uD558\\uC2DC\\uC624.\",\n        className: styles.select_rdt,\n        isSearchable: true // onChange = {e => console.log(e)}\n        ,\n        onChange: e => setRDT(e.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: styles.complete_btn,\n      onClick: () => Upload(),\n      children: \"\\uC81C\\uCD9C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 201,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SubmitterSubmit, \"xoFti9YSDYoAUFbpEQWBgdNcudU=\", false, function () {\n  return [useHistory];\n});\n\n_c = SubmitterSubmit;\n\nvar _c;\n\n$RefreshReg$(_c, \"SubmitterSubmit\");","map":{"version":3,"sources":["/Users/hyunkang/Desktop/School/3-2/데이터베이스/Database2020/client/src/Components/SubmitterSubmit.js"],"names":["React","useState","Component","useEffect","styles","CloseIcon","useHistory","colors","IconButton","parse","RPair","Select","SubmitterSubmit","taskName","taskDesc","setTogglePopUp","logInfo","history","loggedIn","localStorage","getItem","JSON","push","RDTtypes","setRDTtypes","RDTID","setRDT","highlighted","setHighlighted","file","setFile","LastRDSFID","setLastRDSFID","RDSFID","setRDSFID","axios","require","default","uploadState","setUploadState","lst","trmap","setTRMap","trmaplist","setTRMaplist","pdsfID","setPDSFID","qtestID","setQTESTID","aID","accountID","pID","qID","fetchData","get","then","res","data","i","length","name","type","map","Upload","console","log","post","SubmitterID","TaskName","response","catch","error","obj","stringify","Pair","obj1","obj2","constructor","Object","n","j","PDSFID","TestID","popup_sub","close_btn","position","info","file_input","border_blue","border_black","e","preventDefault","Array","from","dataTransfer","files","filter","forEach","text","result","header","existing","select_rdt","value","complete_btn"],"mappings":"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","sourcesContent":["import React, { useState, Component, useEffect } from \"react\";\nimport styles from \"../CSS/component.module.css\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { useHistory } from \"react-router-dom\";\nimport { colors, IconButton } from \"@material-ui/core\";\nimport { parse } from \"papaparse\";\nimport { RPair } from \"../Components/classes\";\nimport Select from \"react-select\";\n\nexport const SubmitterSubmit = ({ taskName, taskDesc, setTogglePopUp }) => {\n  var logInfo;\n  var history = useHistory();\n  const loggedIn = localStorage.getItem(\"user\");\n  if (loggedIn) {\n    logInfo = JSON.parse(loggedIn);\n  } else {\n    history.push(\"/\");\n  }\n\n  const [RDTtypes, setRDTtypes] = useState();\n  const [RDTID, setRDT] = useState();\n  const [highlighted, setHighlighted] = React.useState(false);\n  const [file, setFile] = useState([]);\n  const [LastRDSFID, setLastRDSFID] = useState([]);\n  const [RDSFID, setRDSFID] = useState();\n  const axios = require(\"axios\").default;\n  const [uploadState, setUploadState] = useState(\n    \"제출할 파일을 끌어다 놓으시오.\"\n  );\n  var lst = [];\n  //\n  const [trmap, setTRMap] = useState();\n  const [trmaplist, setTRMaplist] = useState([]);\n\n  const [pdsfID, setPDSFID] = useState();\n  const [qtestID, setQTESTID] = useState([]);\n\n  var aID = logInfo.accountID;\n  var pID;\n  var qID;\n  //console.log(aID);\n\n  useEffect(() => {\n    async function fetchData() {\n      await axios.get(`/api/RDTtypes/${taskName}`).then((res) => {\n        setRDTtypes(res.data);\n      });\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    async function fetchData() {\n      await axios.get(`/api/getLastRDSFID/${logInfo.accountID}`).then((res) => {\n        setLastRDSFID(res.data);\n      });\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    for (let i = 0; i < LastRDSFID.length; i++) {\n      if (LastRDSFID[i].LastRDSFID == null) {\n        setRDSFID(1);\n      } else {\n        setRDSFID(LastRDSFID[i].LastRDSFID + 1);\n      }\n    }\n  }, [LastRDSFID]);\n\n  useEffect(() => {\n    if (!trmap) return;\n    var trmaplist = [];\n    for (let i = 0; i < trmaplist.length; i++) {\n      trmaplist.push(\n        new RPair(trmaplist[i].name, trmaplist[i].type, trmaplist[i].map)\n      );\n    }\n    setTRMaplist(trmaplist);\n  }, [trmap]);\n\n  const Upload = async () => {\n    // process uploading\n\n    console.log(RDTID);\n    console.log(RDSFID);\n\n    await axios\n      .post(\n        `/api/file/SubmitterID_${logInfo.accountID}/${taskName}/RDTID_${RDTID}`,\n        {\n          SubmitterID: logInfo.accountID,\n          TaskName: taskName,\n          RDTID: RDTID,\n          RDSFID: RDSFID,\n          file: file,\n        }\n      )\n      .then(function (response) {\n        console.log(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n\n    await axios.get(`/api/TRMap/${RDTID}`).then((res) => {\n      setTRMap(res.data);\n      var obj = JSON.parse(JSON.stringify(res.data));\n      console.log(obj[0].Pair);\n      var obj1 = JSON.parse(obj[0].Pair);\n      var obj2 = JSON.parse(obj[0].RPair);\n      console.log(obj1);\n      console.log(obj2);\n      for (let i = 0; i < obj1.length; i++) {\n        if (obj2[i].constructor != Object) {\n          var n = obj1[1].name;\n          console.log(obj1[i].name);\n          for (let j = 0; j < file.length; j++) {\n            delete file[i].n;\n          }\n        }\n      }\n      console.log(file);\n    });\n    /*\n     */\n\n    //        var obj = JSON.parse(trmap);\n\n    /*\n  var logInfo;\n  var history = useHistory();\n  const loggedIn = localStorage.getItem(\"user\");\n  if (loggedIn) {\n      logInfo = JSON.parse(loggedIn);\n  } else {\n      history.push(\"/\");\n  }\n  await axios\n      .post(\"/api/file/rdsf\", {\n          SubmitterID: logInfo.accountID,\n          RawDataType: rdt,\n      })\n      .then(function (response) {\n          //console.log(response);\n      })\n      .catch(function (error) {\n          //console.log(error);\n      });\n      */\n    //rdsf.query->parsing->pdsf.query->    upload->assigning->assign.query->qt.query\n    //submitterid_taskid_rawdatatypeid\n\n    await axios\n      .post(\"/api/parse/\" + `${RDSFID}`)\n      .then(function (response) {\n        //console.log(response);\n      })\n      .catch(function (error) {\n        //console.log(error);\n      });\n\n    ///////////////12.06.0700\n\n    await axios.get(`/api/getPDSFID/` + `${RDSFID}`).then((res) => {\n      console.log(RDSFID);\n      console.log(res.data[0].PDSFID);\n\n      setPDSFID(res.data[0].PDSFID);\n      pID = res.data[0].PDSFID;\n    });\n    console.log(pID);\n    await axios\n      .post(\"/api/addQT/\" + `${pID}`)\n      .then(function (response) {\n        //console.log(response);\n      })\n      .catch(function (error) {\n        //console.log(error);\n      });\n\n    await axios.get(`/api/getQTESTID/` + `${pID}`).then((res) => {\n      console.log(res.data);\n      setQTESTID(res.data.TestID);\n      qID = res.data[0].TestID;\n    });\n\n    await axios\n      .post(\"/api/assign/\" + `${pID}/${qID}`, {})\n      .then(function (response) {\n        //console.log(response);\n      })\n      .catch(function (error) {\n        //console.log(error);\n      });\n\n    setTogglePopUp(false);\n  };\n\n  return (\n    <div className={styles.popup_sub}>\n      <IconButton\n        className={styles.close_btn}\n        style={{ position: \"absolute\" }}\n        onClick={() => setTogglePopUp(false)}\n      >\n        <CloseIcon fontSize=\"large\" />\n      </IconButton>\n      <div className={styles.info}>\n        <h3>태스크 이름</h3>\n        <p>{taskName}</p>\n      </div>\n      <div className={styles.info}>\n        <h3>태스크 정보</h3>\n        <p>{taskDesc}</p>\n      </div>\n\n      <h3>파일 업로드</h3>\n      <div\n        className={`${styles.file_input} ${\n          highlighted ? `${styles.border_blue}` : `${styles.border_black}`\n        }`}\n        onDragEnter={() => {\n          setHighlighted(true);\n        }}\n        onDragLeave={() => {\n          setHighlighted(false);\n        }}\n        onDragOver={(e) => {\n          e.preventDefault();\n        }}\n        onDrop={(e) => {\n          e.preventDefault();\n          setHighlighted(false);\n\n          Array.from(e.dataTransfer.files)\n            .filter((file) => file.type === \"text/csv\")\n            .forEach(async (file) => {\n              const text = await file.text();\n              const result = parse(text, { header: true });\n              console.log(result);\n              setFile((existing) => [...existing, ...result.data]);\n            });\n        }}\n      >\n        {uploadState}\n      </div>\n\n      <div className={styles.info}>\n        <h3>Raw Data Type</h3>\n\n        <Select\n          options={RDTtypes}\n          placeholder=\"Raw Data Type을 선택하시오.\"\n          className={styles.select_rdt}\n          isSearchable\n          // onChange = {e => console.log(e)}\n          onChange={(e) => setRDT(e.value)}\n        ></Select>\n      </div>\n\n      <button className={styles.complete_btn} onClick={() => Upload()}>\n        제출\n      </button>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}